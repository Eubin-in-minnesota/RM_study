---
title: 'RM: Option Pricing'
author: "Eubin Lim"
date: "Feb 12th, 2021"
output:
  rmarkdown::github_document
---
## Option
### 기초 개념
* 미래의 일정 시점에 일정 가격으로 주식, 채권, 통화 등의 기초자산을 매수하거나 매도할 수 있는 권리 \   
* Option buyer: 옵션을 행사할 권리를 보유하되 의무는 없음. 좋은 결과만 얻을 수 있는 대신 상응하는 대가(옵션 프리미엄) 지불해야 함
* Option seller: 옵션 프리미엄을 수취하고 옵션 매수자의 옵션 행사에 응해야 할 의무 있음
* 옵션의 손익구조: 비대칭적
  + Option buyer: 손실 제한, 이익 무제한
  + Option seller: 이익 제한, 손실 무제한
* Call option: 약정일에 약정 행사가격으로 기초자산을 매수할 수 있는 권리
* Put option: 약정일에 약정 행사가격으로 기초자산을 매도할 수 있는 권리

### Application

#### Put-Call Parity:
* 콜옵션과 풋옵션 간에는 일정한 등가관계 성립
* 같은 가격으로 행사하게 되는 call 가격과 put 가격은 동일한 가치를 가짐
* Formula: $c+Ke^{-rT}=p+S_t$ \ 


## Black-Scholes Model: Option Pricing for European Option
*Call option: $c=S_0N(d_1)-Ke^{-rT}N(d_2)$ \     
*Put option: $p=Ke^{-rT}N(d_2)-S_0N(d_1)$ \     
where $d_1=\frac{\ln(S_0/K)+(r+\sigma^2/2)T}{\sigma\sqrt{T}}$ \     
$d_2=\frac{\ln(S_0/K)+(r-\sigma^2/2)T}{\sigma\sqrt{T}}=d_1-\sigma\sqrt{T}$ \ 

p.s. European Option: 만기일에만 권리를 행사할 수 있음

### Premise
*(안전자산) 안전자산의 수익률은 변화가 없는 '무위험 수익률'   \  
*(랜덤워크) 기초자산가격의 순간 로그 수익률은 무한한 임의보행(Brownian motion)

### Option Parameters
| Parameter       	| 설명                                                                                                                                                      	|
|-----------------	|-----------------------------------------------------------------------------------------------------------------------------------------------------------	|
| $S$ 기초자산가격  	| - 행사가격과 기초자산가격 간의 차이는 만기 시 옵션가격과 밀접한 관계  <br /> - 만기에는 내재가치가 남아 있거나 옵션가치가 0이 됨 <br />  - 옵션 가격 결정에 가장 큰 영향 	|
| $K$ 행사가격      	| - 모든 옵션은 옵션을 행사할 때 적용되는 가격을 갖게 됨 <br /> - 다양한 행사가격을 두는 이유는 다양한 risk/reward 관계를 제공함으로써 선택 범위 확장              	|
| $T$ 잔존만기      	| - 잔존만기가 길수록 옵션의 가치가 더 큼                                                                                                                   	|
| $r$ 이자율        	| - 현물옵션의 경우 이자율 고려함(cost of carry) <br /> - put-call parity()에 영향끼침 <br /> - 금리가 올라갈 경우 콜옵션 가격 상승                                       	|
| $\sigma$ 변동성   	| - volatility는 불확실성의 양을 나타내는 표현법 <br /> - 내재변동성 vs 실현변동성 <br /> - 위험과 수익은 trade-off 관계       

```{r}
s=280 # 기초자산 가격
k=280 # 행사가격
t=21/252 # 기간(연단위)
r=0.0354 # 연 이자율
sigma=0.2294 # 변동성(연 단위)

d1=(log(s/k)+(r+sigma^2/2)*t)/(sigma*sqrt(t))
d2=d1-sigma*sqrt(t)

call=s*pnorm(d1, mean=0, sd=1)-k*exp(-r*t)*pnorm(d2, mean=0, sd=1)
call
put=k*exp(-r*t)*pnorm(-d2, mean=0, sd=1)-s*pnorm(-d1, mean=0, sd=1)
put
```
## Pricing function
* Call: position=1   \    
* Put: position=2
```{r}
pricing=function(position,s,k,t,r,sigma){
  d1=(log(s/k)+(r+sigma^2/2)*t)/(sigma*sqrt(t))
  d2=d1-sigma*sqrt(t)
  # call: position=1
  if(position==1){
    result=s*pnorm(d1, mean=0, sd=1)-k*exp(-r*t)*pnorm(d2, mean=0, sd=1)
  }
  # put: position=1
  else{
    result=k*exp(-r*t)*pnorm(-d2, mean=0, sd=1)-s*pnorm(-d1, mean=0, sd=1)
  }
  return(result)
}
pricing(1, 100, 110, 21/252, 0.0354, 0.2294)
```
 
## Sensitivity a.k.a Greeks
| Greeks         	| Based on     	    | Formula                                	| Description                                                                                                                                                                         	|
|----------------	|------------------	|----------------------------------------	|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------	|
| Delta $\delta$ 	| $S$ 기초자산 	| $\delta=\frac{\partial f}{\partial S}$     	| - 주가 1단위 변동 시 옵션 가격 변동 비율 <br /> - call: 0.00-1.00, put: -1.00-0.00                                                                                                         	|
| Gamma $\gamma$ 	| $S$ 기초자산 	| $\gamma=\frac{\partial^2 f}{\partial S^2}$ 	| - 기초자산 변동에 따른 델타의 변동 비율 <br /> - Gamma가 0.05, delta가 0.53일 때, 주가가 1단위 상승한다면 새로운 call delta는 0.58 <br /> - 옵션 매수는 long gamma(+), 옵션 매도는 short gamma(-) 	|
| Theta $\theta$ 	| $T$ 시간     	| $\theta=\frac{\partial f}{\partial T}$     	| - 1일 결과에 따른 옵션의 시간 가치 감소 <br /> - Theta가 0.2이고 콜 종가 $4.25이며 주가 변동 없다면 익일 개시가는 $4.05                                                                    	|
| Vega $\nu$   	| $v$ 변동성   	| $\nu=\frac{\partial f}{\partial \sigma}$ 	| - 변동성 1%에 대한 옵션가격 변동 <br /> - Vega 0.25, 콜 이론가 $2.50이면 변동성 1% 상승 시 이론가 $2.75로 변동                                                                             	|
| Rho $\rho$     	| $r$ 이자율   	| $\rho=\frac{\partial f}{\partial r}$       	| - 시장이자율 1% 변동에 대한 옵션가격 변동 <br /> - Rho 0.06, 콜 이론가 $3.50이면 금리 1% 상승 시 콜 가격 $3.56                                                                             	|


